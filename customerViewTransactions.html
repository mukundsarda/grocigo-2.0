<!DOCTYPE html>
<html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<head>
  <link rel='stylesheet' href="style.css">
  <title>My Transactions</title>
  <script src="js/api.js"></script>
  <script src="js/ui.js"></script>
</head>
<body>
  <div class="topStyle">
    <h2 style="color:white;">&nbsp &nbspGrocigo</h2>
    <a class='userNameDisplay'></a>
    <div class="solid"></div>
  </div>
  <div class='sidebar'>
    <button onclick="location.href='customerHome.html'">Home</button>
    <button onclick="location.href='viewProductsCustomer.html'">View Products</button>
    <button onclick="location.href='order.html'">Order</button>
    <button onclick="location.href='cart.html'">Cart</button>
    <button onclick="location.href='customerViewTransactions.html'">My Transactions</button>
    <button id="logoutBtn">Logout</button>
  </div>
  <div class='container'>
    <fieldset><legend><b>My Transactions</b></legend>
      <table class='tableLarge' id="txTable"><tr><th>Transaction ID</th><th>Amount</th><th>Payment Mode</th><th>Phone</th><th>Address</th><th>Date</th></tr><tbody></tbody></table>
    </fieldset>
  </div>
  <script>
    (async () => {
      const uid = await GrocigoUI.requireLoginAndSetUser();
      if (!uid) return;
      const tbody = document.querySelector('#txTable tbody');
      const rows = await GrocigoAPI.getTransactions(false);
      rows.forEach(row => {
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${row.transaction_id}</td><td>${row.transaction_amount}</td><td>${row.payment}</td><td>${row.phone}</td><td style='font-size: 15px;'>${row.address}</td><td>${row.date}</td>`;
        tbody.appendChild(tr);
      });
    })();
    document.getElementById('logoutBtn').onclick = async () => { await GrocigoAPI.logout(); location.href = 'login.html'; };
  </script>
</body>
</html>
